@model IEnumerable<KargoTakibi.Models.Kargo>

@{
    ViewData["Title"] = "Kargo Listesi";
}

<div class="form-page-container" style="max-width: 1200px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
        <div>
            <h1 style="font-size: 2rem; font-weight: 800; margin-bottom: 0.35rem;">Kargo Yönetimi</h1>
            <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem;">Sisteminizdeki tüm gönderileri takip edin ve yönetin.</p>
        </div>
        <a asp-action="Ekle" class="btn btn-primary">
            <i class="bi bi-plus-lg"></i> Yeni Kayıt Oluştur
        </a>
    </div>

    <div class="card-glass" style="padding: 0; overflow: hidden;">
        <div style="padding: 1rem 1.25rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.02); flex-wrap: wrap; gap: 1rem;">
            <div style="display: flex; gap: 0.75rem; align-items: center;">
                <div style="font-weight: 700; font-size: 0.95rem; color: var(--text-main);">Tüm Gönderiler</div>
                <span class="badge badge-neutral" style="font-size: 0.75rem;">@Model.Count() Kayıt</span>
            </div>
            <div class="input-wrap" style="width: 250px;">
                <input type="text" id="kargoSearch" class="form-control" placeholder="Hızlı ara..." style="padding: 0.5rem 2.25rem 0.5rem 0.9rem; font-size: 0.85rem;" />
                <i class="bi bi-search" style="right: 0.9rem;"></i>
            </div>
        </div>

        <div class="table-container" style="border: none; border-radius: 0;">
            <table class="table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Alıcı / Gönderici</th>
                        <th>Rota</th>
                        <th>Durum</th>
                        <th style="text-align: right;">İşlemler</th>
                    </tr>
                </thead>
                <tbody id="kargoTableBody">
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td style="font-weight: 700; color: var(--primary); font-size: 0.9rem;">#@(item.TakipNo ?? "YENİ")</td>
                            <td>
                                <div style="display: flex; flex-direction: column; gap: 0.15rem;">
                                    <div style="font-weight: 700; font-size: 0.9rem;">@item.AliciAd</div>
                                    <div style="font-size: 0.7rem; color: var(--text-muted);">Gönderen: @item.GondericiAd</div>
                                </div>
                            </td>
                            <td>
                                <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.8rem;">
                                    <span style="color: var(--text-secondary);">@item.GondericiIl</span>
                                    <i class="bi bi-arrow-right" style="color: var(--primary); font-size: 0.7rem;"></i>
                                    <span style="font-weight: 700;">@item.AliciIl</span>
                                </div>
                            </td>
                            <td>
                                @{
                                    var badgeClass = item.Durum switch {
                                        "Teslim Edildi" => "badge-success",
                                        "Yolda" => "badge-info",
                                        "Kabul Edildi" => "badge-warning",
                                        "İptal Edildi" => "badge-danger",
                                        _ => "badge-neutral"
                                    };
                                }
                                <span class="badge @badgeClass" style="font-size: 0.7rem;">@item.Durum</span>
                            </td>
                            <td style="text-align: right;">
                                <div style="display: flex; justify-content: flex-end; gap: 0.35rem;">
                                    <a asp-action="Detay" asp-route-id="@item.KargoID" class="btn btn-secondary btn-sm" title="Detay">
                                        <i class="bi bi-eye"></i>
                                    </a>
                                    <a asp-action="Duzenle" asp-route-id="@item.KargoID" class="btn btn-secondary btn-sm" title="Düzenle">
                                        <i class="bi bi-pencil-square"></i>
                                    </a>
                                    <a asp-controller="Hareket" asp-action="KargoHareketleri" asp-route-id="@item.KargoID" class="btn btn-secondary btn-sm" title="Takip">
                                        <i class="bi bi-geo-alt"></i>
                                    </a>
                                    <form asp-action="Sil" asp-route-id="@item.KargoID" method="post" data-confirm data-confirm-title="Kargo Kaydını Sil" data-confirm-message="Bu kargo kaydı kalıcı olarak silinecek. Devam etmek istiyor musunuz?" data-confirm-btn="Evet, Sil" style="display:inline;">
                                        <button type="submit" class="btn btn-danger btn-sm">
                                            <i class="bi bi-trash3"></i>
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $("#kargoSearch").on("keyup", function() {
                var value = $(this).val().toLowerCase();
                $("#kargoTableBody tr").filter(function() {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>
}
