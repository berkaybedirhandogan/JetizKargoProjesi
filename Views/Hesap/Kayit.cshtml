@model KargoTakibi.Models.Kullanici

@{
    ViewData["Title"] = "Üye Ol";
}

<div class="row justify-center" style="min-height: 80vh; align-items: center;">
    <div class="col-lg-4 col-md-6 col-11">
        <div class="card-glass" style="border-bottom: 4px solid var(--primary); padding: 2.5rem 2rem;">
            <div style="text-align: center; margin-bottom: 2.5rem;">
                <div style="width: 64px; height: 64px; margin: 0 auto 1.5rem auto; background: rgba(225, 29, 72, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary);">
                    <i class="bi bi-person-plus-fill" style="font-size: 1.75rem;"></i>
                </div>
                <h1 style="font-size: 1.75rem; margin-bottom: 0.5rem;">Üye Olun</h1>
                <p style="font-size: 0.95rem; color: var(--text-secondary);">Hemen aramıza katılın ve kargolarınızı yönetin</p>
            </div>

            <form asp-action="Kayit" method="post" id="kayitForm">
                <div asp-validation-summary="ModelOnly" class="badge badge-danger w-100 mb-4" style="padding: 0.75rem; text-align: left;"></div>

                <div class="form-group">
                    <label asp-for="AdSoyad" class="form-label">Ad Soyad</label>
                    <div class="input-wrap">
                        <input asp-for="AdSoyad" class="form-control" placeholder="Adınız Soyadınız" />
                        <i class="bi bi-person-circle"></i>
                    </div>
                    <span asp-validation-for="AdSoyad" class="text-danger" style="font-size: 0.8rem; margin-top: 0.4rem; display: block;"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Email" class="form-label">E-posta Adresi</label>
                    <div class="input-wrap">
                        <input asp-for="Email" class="form-control" placeholder="örnek@sirket.com" />
                        <i class="bi bi-envelope-at"></i>
                    </div>
                    <span asp-validation-for="Email" class="text-danger" style="font-size: 0.8rem; margin-top: 0.4rem; display: block;"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Sifre" class="form-label">Şifre</label>
                    <div class="input-wrap" style="position: relative;">
                        <input asp-for="Sifre" type="password" class="form-control" id="sifreInput" placeholder="En az 8 karakter, harf ve rakam" style="padding-right: 3rem;" />
                        <button type="button" onclick="togglePassword('sifreInput', this)" style="position: absolute; right: 0; top: 0; height: 100%; width: 3rem; background: none; border: none; color: var(--text-muted); cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 10;">
                            <i class="bi bi-eye" style="position: static !important; transform: none !important; pointer-events: none;"></i>
                        </button>
                    </div>
                    <span asp-validation-for="Sifre" class="text-danger" style="font-size: 0.8rem; margin-top: 0.4rem; display: block;"></span>
                    
                    <div id="password-strength" style="margin-top: 1rem; display: none;">
                        <div style="height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; display: flex;">
                            <div id="strength-bar" style="height: 100%; width: 0%; transition: all 0.3s; background: var(--primary);"></div>
                        </div>
                        <span id="strength-text" style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.4rem; display: block;">Zayıf Şifre</span>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary w-100" style="margin-top: 1rem; padding: 1rem;">
                    <i class="bi bi-rocket-takeoff-fill"></i> Hesabı Oluştur
                </button>
            </form>

            <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border); text-align: center;">
                <span style="color: var(--text-secondary); font-size: 0.9rem;">Zaten hesabınız var mı?</span>
                <a asp-action="Giris" style="color: var(--primary); font-weight: 700; margin-left: 0.5rem; text-decoration: underline;">Giriş Yap</a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function togglePassword(inputId, btn) {
            var input = document.getElementById(inputId);
            var icon = btn.querySelector('i');
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'bi bi-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'bi bi-eye';
            }
        }

        $(document).ready(function() {
            $('#sifreInput').on('input', function() {
                const password = $(this).val();
                const strengthDiv = $('#password-strength');
                const bar = $('#strength-bar');
                const text = $('#strength-text');

                if (password.length > 0) {
                    strengthDiv.fadeIn();
                    
                    let points = 0;
                    
                    if (password.length >= 8) points++;
                    if (password.length >= 12) points++;
                    
                    if (/[a-z]/.test(password)) points++;
                    if (/[A-Z]/.test(password)) points++;
                    if (/\d/.test(password)) points++;
                    if (/[@@$!%*?&._]/.test(password)) points++;

                    let percentage = (points / 6) * 100;
                    bar.css('width', percentage + '%');
                    
                    if (points <= 2) {
                        bar.css('background', 'var(--danger)');
                        text.html('<i class="bi bi-shield-x"></i> Çok Zayıf - Harf, rakam ve sembol ekleyin');
                    } else if (points <= 4) {
                        bar.css('background', 'var(--warning)');
                        text.html('<i class="bi bi-shield-shaded"></i> Orta Seviye - Güvenlik için sembol ekleyin');
                    } else if (points < 6) {
                        bar.css('background', '#3b82f6');
                        text.html('<i class="bi bi-shield-lock-fill"></i> Güçlü Şifre');
                    } else {
                        bar.css('background', 'var(--success)');
                        text.html('<i class="bi bi-shield-check"></i> Mükemmel! Çok Güçlü');
                    }
                } else {
                    strengthDiv.fadeOut();
                }
            });
        });
    </script>
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
